<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>

<!--
<div class="td-toc"><nav id="TableOfContents"><div>
            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#OEPlacement">OEPlacement</a>
            </li>
            <li>
                    <a class="function" href="#RayTracingCalculation">RayTracingCalculation</a>
            </li>
            <li>
                    <a class="function" href="#FindOptimalDistance">FindOptimalDistance</a>
            </li>
            <li>
                    <a class="function" href="#FindCentralRay">FindCentralRay</a>
            </li>
            <li>
                    <a class="function" href="#StandardDeviation">StandardDeviation</a>
            </li>
            <li>
                    <a class="function" href="#WeightedStandardDeviation">WeightedStandardDeviation</a>
            </li>
            <li>
                    <a class="function" href="#ReturnNumericalAperture">ReturnNumericalAperture</a>
            </li>
            <li>
                    <a class="function" href="#ReturnAiryRadius">ReturnAiryRadius</a>
            </li>
            <li>
                    <a class="function" href="#save_compressed">save_compressed</a>
            </li>
            <li>
                    <a class="function" href="#load_compressed">load_compressed</a>
            </li>
    </ul>

</div></nav></div>
-->


<div class="pdoc">
                <section id="OEPlacement">
                            <input id="OEPlacement-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">OEPlacement</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">SourceProperties</span><span class="p">:</span> <span class="nb">dict</span>,</span><span class="param">	<span class="n">OpticsList</span><span class="p">:</span> <span class="nb">list</span>,</span><span class="param">	<span class="n">DistanceList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">IncidenceAngleList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>,</span><span class="param">	<span class="n">IncidencePlaneAngleList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">Description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="OEPlacement-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#OEPlacement"></a>
            <div class="chroma pdoc-code"><pre><span></span><span id="OEPlacement-134"><a href="#OEPlacement-134"><span class="linenos">134</span></a><span class="k">def</span> <span class="nf">OEPlacement</span><span class="p">(</span>
</span><span id="OEPlacement-135"><a href="#OEPlacement-135"><span class="linenos">135</span></a>    <span class="n">SourceProperties</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="OEPlacement-136"><a href="#OEPlacement-136"><span class="linenos">136</span></a>    <span class="n">OpticsList</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="OEPlacement-137"><a href="#OEPlacement-137"><span class="linenos">137</span></a>    <span class="n">DistanceList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)],</span>
</span><span id="OEPlacement-138"><a href="#OEPlacement-138"><span class="linenos">138</span></a>    <span class="n">IncidenceAngleList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
</span><span id="OEPlacement-139"><a href="#OEPlacement-139"><span class="linenos">139</span></a>    <span class="n">IncidencePlaneAngleList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="OEPlacement-140"><a href="#OEPlacement-140"><span class="linenos">140</span></a>    <span class="n">Description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="OEPlacement-141"><a href="#OEPlacement-141"><span class="linenos">141</span></a><span class="p">):</span>
</span><span id="OEPlacement-142"><a href="#OEPlacement-142"><span class="linenos">142</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="OEPlacement-143"><a href="#OEPlacement-143"><span class="linenos">143</span></a><span class="sd">    Automatically place optical elements in the &quot;lab frame&quot; according to given distances and incidence angles.</span>
</span><span id="OEPlacement-144"><a href="#OEPlacement-144"><span class="linenos">144</span></a><span class="sd">    Outputs an OpticalChain-object.</span>
</span><span id="OEPlacement-145"><a href="#OEPlacement-145"><span class="linenos">145</span></a>
</span><span id="OEPlacement-146"><a href="#OEPlacement-146"><span class="linenos">146</span></a><span class="sd">    The source is placed at the origin, and points into the x-direction. The optical elements then follow.</span>
</span><span id="OEPlacement-147"><a href="#OEPlacement-147"><span class="linenos">147</span></a>
</span><span id="OEPlacement-148"><a href="#OEPlacement-148"><span class="linenos">148</span></a><span class="sd">    As long as the angles in IncidencePlaneAngleList are 0, the incidence plane remains the x-z plane, i.e.</span>
</span><span id="OEPlacement-149"><a href="#OEPlacement-149"><span class="linenos">149</span></a><span class="sd">    the optical elements are rotated about the y-axis to set the desired incidence angle between OE-normal</span>
</span><span id="OEPlacement-150"><a href="#OEPlacement-150"><span class="linenos">150</span></a><span class="sd">    and the direction of incidence of the incoming ray-bundle. Otherwise, the incidence plane gets rotated.</span>
</span><span id="OEPlacement-151"><a href="#OEPlacement-151"><span class="linenos">151</span></a>
</span><span id="OEPlacement-152"><a href="#OEPlacement-152"><span class="linenos">152</span></a><span class="sd">    One of the elements of one of the lists &#39;DistanceList&#39;, &#39;IncidenceAngleList&#39;, or &#39;IncidencePlaneAngleList&#39;</span>
</span><span id="OEPlacement-153"><a href="#OEPlacement-153"><span class="linenos">153</span></a><span class="sd">    can be a list or a numpy-array. In that case, a list of OpticalChain-objects is created which can be looped over.</span>
</span><span id="OEPlacement-154"><a href="#OEPlacement-154"><span class="linenos">154</span></a>
</span><span id="OEPlacement-155"><a href="#OEPlacement-155"><span class="linenos">155</span></a><span class="sd">    Parameters</span>
</span><span id="OEPlacement-156"><a href="#OEPlacement-156"><span class="linenos">156</span></a><span class="sd">    ----------</span>
</span><span id="OEPlacement-157"><a href="#OEPlacement-157"><span class="linenos">157</span></a><span class="sd">        SourceProperties : dict</span>
</span><span id="OEPlacement-158"><a href="#OEPlacement-158"><span class="linenos">158</span></a><span class="sd">            Dictionary with the keys &quot;Divergence&quot; :float, &quot;SourceSize&quot; :float,</span>
</span><span id="OEPlacement-159"><a href="#OEPlacement-159"><span class="linenos">159</span></a><span class="sd">            &quot;NumberRays&quot; :int, and &quot;Wavelength&quot; :float.</span>
</span><span id="OEPlacement-160"><a href="#OEPlacement-160"><span class="linenos">160</span></a><span class="sd">            This determines the source ray-bundle that is created.</span>
</span><span id="OEPlacement-161"><a href="#OEPlacement-161"><span class="linenos">161</span></a>
</span><span id="OEPlacement-162"><a href="#OEPlacement-162"><span class="linenos">162</span></a><span class="sd">        OpticsList : list[Optics-class-objects (Mirorrs or Masks)]</span>
</span><span id="OEPlacement-163"><a href="#OEPlacement-163"><span class="linenos">163</span></a><span class="sd">            List of Optics-objects.</span>
</span><span id="OEPlacement-164"><a href="#OEPlacement-164"><span class="linenos">164</span></a>
</span><span id="OEPlacement-165"><a href="#OEPlacement-165"><span class="linenos">165</span></a><span class="sd">        DistanceList : list[float]</span>
</span><span id="OEPlacement-166"><a href="#OEPlacement-166"><span class="linenos">166</span></a><span class="sd">            List of distances, in mm,  at which place the optics out of the</span>
</span><span id="OEPlacement-167"><a href="#OEPlacement-167"><span class="linenos">167</span></a><span class="sd">            OpticsList from the precending one. For the first optic, this is</span>
</span><span id="OEPlacement-168"><a href="#OEPlacement-168"><span class="linenos">168</span></a><span class="sd">            the distance from the light source.</span>
</span><span id="OEPlacement-169"><a href="#OEPlacement-169"><span class="linenos">169</span></a>
</span><span id="OEPlacement-170"><a href="#OEPlacement-170"><span class="linenos">170</span></a><span class="sd">            One of the elements can ne a list or a numpy-array instead of a float.</span>
</span><span id="OEPlacement-171"><a href="#OEPlacement-171"><span class="linenos">171</span></a><span class="sd">            In that case, a list of OpticalChain-objects is created which can be looped over.</span>
</span><span id="OEPlacement-172"><a href="#OEPlacement-172"><span class="linenos">172</span></a>
</span><span id="OEPlacement-173"><a href="#OEPlacement-173"><span class="linenos">173</span></a><span class="sd">        IncidenceAngleList : list[float]</span>
</span><span id="OEPlacement-174"><a href="#OEPlacement-174"><span class="linenos">174</span></a><span class="sd">            List of incidence angles, in degrees, measured between the central ray</span>
</span><span id="OEPlacement-175"><a href="#OEPlacement-175"><span class="linenos">175</span></a><span class="sd">            of the incident ray bundle and the normal on the optical element.</span>
</span><span id="OEPlacement-176"><a href="#OEPlacement-176"><span class="linenos">176</span></a>
</span><span id="OEPlacement-177"><a href="#OEPlacement-177"><span class="linenos">177</span></a><span class="sd">            One of the elements can ne a list or a numpy-array instead of a float.</span>
</span><span id="OEPlacement-178"><a href="#OEPlacement-178"><span class="linenos">178</span></a><span class="sd">            In that case, a list of OpticalChain-objects is created which can be looped over.</span>
</span><span id="OEPlacement-179"><a href="#OEPlacement-179"><span class="linenos">179</span></a>
</span><span id="OEPlacement-180"><a href="#OEPlacement-180"><span class="linenos">180</span></a><span class="sd">        IncidencePlaneAngleList : list[float], optional</span>
</span><span id="OEPlacement-181"><a href="#OEPlacement-181"><span class="linenos">181</span></a><span class="sd">            List of angles, in degrees, by which the incidence plane is rotated</span>
</span><span id="OEPlacement-182"><a href="#OEPlacement-182"><span class="linenos">182</span></a><span class="sd">            on the optical element with respect to that on the preceding one.</span>
</span><span id="OEPlacement-183"><a href="#OEPlacement-183"><span class="linenos">183</span></a><span class="sd">            Consequently, for the first element, this angle has no qualitative effect.</span>
</span><span id="OEPlacement-184"><a href="#OEPlacement-184"><span class="linenos">184</span></a>
</span><span id="OEPlacement-185"><a href="#OEPlacement-185"><span class="linenos">185</span></a><span class="sd">            One of the elements can ne a list or a numpy-array instead of a float.</span>
</span><span id="OEPlacement-186"><a href="#OEPlacement-186"><span class="linenos">186</span></a><span class="sd">            In that case, a list of OpticalChain-objects is created which can be looped over.</span>
</span><span id="OEPlacement-187"><a href="#OEPlacement-187"><span class="linenos">187</span></a>
</span><span id="OEPlacement-188"><a href="#OEPlacement-188"><span class="linenos">188</span></a><span class="sd">        Description : str, optional</span>
</span><span id="OEPlacement-189"><a href="#OEPlacement-189"><span class="linenos">189</span></a><span class="sd">            A string to describe the optical setup.</span>
</span><span id="OEPlacement-190"><a href="#OEPlacement-190"><span class="linenos">190</span></a>
</span><span id="OEPlacement-191"><a href="#OEPlacement-191"><span class="linenos">191</span></a><span class="sd">    Returns</span>
</span><span id="OEPlacement-192"><a href="#OEPlacement-192"><span class="linenos">192</span></a><span class="sd">    -------</span>
</span><span id="OEPlacement-193"><a href="#OEPlacement-193"><span class="linenos">193</span></a><span class="sd">        OpticalChainList : list[OpticalChain-object]</span>
</span><span id="OEPlacement-194"><a href="#OEPlacement-194"><span class="linenos">194</span></a>
</span><span id="OEPlacement-195"><a href="#OEPlacement-195"><span class="linenos">195</span></a><span class="sd">        or</span>
</span><span id="OEPlacement-196"><a href="#OEPlacement-196"><span class="linenos">196</span></a>
</span><span id="OEPlacement-197"><a href="#OEPlacement-197"><span class="linenos">197</span></a><span class="sd">        OpticalChain : OpticalChain-object</span>
</span><span id="OEPlacement-198"><a href="#OEPlacement-198"><span class="linenos">198</span></a>
</span><span id="OEPlacement-199"><a href="#OEPlacement-199"><span class="linenos">199</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="OEPlacement-200"><a href="#OEPlacement-200"><span class="linenos">200</span></a>
</span><span id="OEPlacement-201"><a href="#OEPlacement-201"><span class="linenos">201</span></a>    <span class="k">if</span> <span class="n">IncidencePlaneAngleList</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="OEPlacement-202"><a href="#OEPlacement-202"><span class="linenos">202</span></a>        <span class="n">IncidencePlaneAngleList</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">OpticsList</span><span class="p">))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="OEPlacement-203"><a href="#OEPlacement-203"><span class="linenos">203</span></a>
</span><span id="OEPlacement-204"><a href="#OEPlacement-204"><span class="linenos">204</span></a>    <span class="n">nest_indx_distance</span> <span class="o">=</span> <span class="n">_which_indeces</span><span class="p">(</span><span class="n">DistanceList</span><span class="p">)</span>
</span><span id="OEPlacement-205"><a href="#OEPlacement-205"><span class="linenos">205</span></a>    <span class="n">nest_indx_incidence</span> <span class="o">=</span> <span class="n">_which_indeces</span><span class="p">(</span><span class="n">IncidenceAngleList</span><span class="p">)</span>
</span><span id="OEPlacement-206"><a href="#OEPlacement-206"><span class="linenos">206</span></a>    <span class="n">nest_indx_incplane</span> <span class="o">=</span> <span class="n">_which_indeces</span><span class="p">(</span><span class="n">IncidencePlaneAngleList</span><span class="p">)</span>
</span><span id="OEPlacement-207"><a href="#OEPlacement-207"><span class="linenos">207</span></a>
</span><span id="OEPlacement-208"><a href="#OEPlacement-208"><span class="linenos">208</span></a>    <span class="n">total_nested</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nest_indx_incidence</span> <span class="o">+</span> <span class="n">nest_indx_incplane</span> <span class="o">+</span> <span class="n">nest_indx_distance</span><span class="p">)</span>
</span><span id="OEPlacement-209"><a href="#OEPlacement-209"><span class="linenos">209</span></a>
</span><span id="OEPlacement-210"><a href="#OEPlacement-210"><span class="linenos">210</span></a>    <span class="k">if</span> <span class="n">total_nested</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="OEPlacement-211"><a href="#OEPlacement-211"><span class="linenos">211</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="OEPlacement-212"><a href="#OEPlacement-212"><span class="linenos">212</span></a>            <span class="s2">&quot;Only one element of one of the lists IncidenceAngleList, IncidencePlaneAngleList, or DistanceList can be a list or array itself. Otherwise things get too tangled...&quot;</span>
</span><span id="OEPlacement-213"><a href="#OEPlacement-213"><span class="linenos">213</span></a>        <span class="p">)</span>
</span><span id="OEPlacement-214"><a href="#OEPlacement-214"><span class="linenos">214</span></a>    <span class="k">elif</span> <span class="n">total_nested</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="OEPlacement-215"><a href="#OEPlacement-215"><span class="linenos">215</span></a>        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">nest_indx_incidence</span> <span class="o">+</span> <span class="n">nest_indx_incplane</span> <span class="o">+</span> <span class="n">nest_indx_distance</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="OEPlacement-216"><a href="#OEPlacement-216"><span class="linenos">216</span></a>        <span class="n">loop_variable_name</span> <span class="o">=</span> <span class="n">OpticsList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="o">+</span> <span class="s2">&quot;_idx_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="OEPlacement-217"><a href="#OEPlacement-217"><span class="linenos">217</span></a>        <span class="k">if</span> <span class="n">nest_indx_incidence</span><span class="p">:</span>  <span class="c1"># if the list is not empty</span>
</span><span id="OEPlacement-218"><a href="#OEPlacement-218"><span class="linenos">218</span></a>            <span class="n">loop_variable_name</span> <span class="o">+=</span> <span class="s2">&quot; incidence angle (deg)&quot;</span>
</span><span id="OEPlacement-219"><a href="#OEPlacement-219"><span class="linenos">219</span></a>            <span class="n">loop_variable</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">IncidenceAngleList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="OEPlacement-220"><a href="#OEPlacement-220"><span class="linenos">220</span></a>            <span class="n">loop_list</span> <span class="o">=</span> <span class="n">IncidenceAngleList</span>
</span><span id="OEPlacement-221"><a href="#OEPlacement-221"><span class="linenos">221</span></a>        <span class="k">elif</span> <span class="n">nest_indx_distance</span><span class="p">:</span>  <span class="c1"># if the list is not empty</span>
</span><span id="OEPlacement-222"><a href="#OEPlacement-222"><span class="linenos">222</span></a>            <span class="n">loop_variable_name</span> <span class="o">+=</span> <span class="s2">&quot; distance (mm)&quot;</span>
</span><span id="OEPlacement-223"><a href="#OEPlacement-223"><span class="linenos">223</span></a>            <span class="n">loop_variable</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">DistanceList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="OEPlacement-224"><a href="#OEPlacement-224"><span class="linenos">224</span></a>            <span class="n">loop_list</span> <span class="o">=</span> <span class="n">DistanceList</span>
</span><span id="OEPlacement-225"><a href="#OEPlacement-225"><span class="linenos">225</span></a>        <span class="k">elif</span> <span class="n">nest_indx_incplane</span><span class="p">:</span>  <span class="c1"># if the list is not empty</span>
</span><span id="OEPlacement-226"><a href="#OEPlacement-226"><span class="linenos">226</span></a>            <span class="n">loop_variable_name</span> <span class="o">+=</span> <span class="s2">&quot; incidence-plane angle rotation (deg)&quot;</span>
</span><span id="OEPlacement-227"><a href="#OEPlacement-227"><span class="linenos">227</span></a>            <span class="n">loop_variable</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">IncidencePlaneAngleList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="OEPlacement-228"><a href="#OEPlacement-228"><span class="linenos">228</span></a>            <span class="n">loop_list</span> <span class="o">=</span> <span class="n">IncidencePlaneAngleList</span>
</span><span id="OEPlacement-229"><a href="#OEPlacement-229"><span class="linenos">229</span></a>
</span><span id="OEPlacement-230"><a href="#OEPlacement-230"><span class="linenos">230</span></a>        <span class="n">OpticalChainList</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="OEPlacement-231"><a href="#OEPlacement-231"><span class="linenos">231</span></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">loop_variable</span><span class="p">:</span>
</span><span id="OEPlacement-232"><a href="#OEPlacement-232"><span class="linenos">232</span></a>            <span class="n">loop_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="OEPlacement-233"><a href="#OEPlacement-233"><span class="linenos">233</span></a>            <span class="n">ModifiedOpticalChain</span> <span class="o">=</span> <span class="n">_singleOEPlacement</span><span class="p">(</span>
</span><span id="OEPlacement-234"><a href="#OEPlacement-234"><span class="linenos">234</span></a>                <span class="n">SourceProperties</span><span class="p">,</span> <span class="n">OpticsList</span><span class="p">,</span> <span class="n">DistanceList</span><span class="p">,</span> <span class="n">IncidenceAngleList</span><span class="p">,</span> <span class="n">IncidencePlaneAngleList</span><span class="p">,</span> <span class="n">Description</span>
</span><span id="OEPlacement-235"><a href="#OEPlacement-235"><span class="linenos">235</span></a>            <span class="p">)</span>
</span><span id="OEPlacement-236"><a href="#OEPlacement-236"><span class="linenos">236</span></a>            <span class="n">ModifiedOpticalChain</span><span class="o">.</span><span class="n">loop_variable_name</span> <span class="o">=</span> <span class="n">loop_variable_name</span>
</span><span id="OEPlacement-237"><a href="#OEPlacement-237"><span class="linenos">237</span></a>            <span class="n">ModifiedOpticalChain</span><span class="o">.</span><span class="n">loop_variable_value</span> <span class="o">=</span> <span class="n">x</span>
</span><span id="OEPlacement-238"><a href="#OEPlacement-238"><span class="linenos">238</span></a>            <span class="n">OpticalChainList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ModifiedOpticalChain</span><span class="p">)</span>
</span><span id="OEPlacement-239"><a href="#OEPlacement-239"><span class="linenos">239</span></a>
</span><span id="OEPlacement-240"><a href="#OEPlacement-240"><span class="linenos">240</span></a>        <span class="k">return</span> <span class="n">OpticalChainList</span>
</span><span id="OEPlacement-241"><a href="#OEPlacement-241"><span class="linenos">241</span></a>
</span><span id="OEPlacement-242"><a href="#OEPlacement-242"><span class="linenos">242</span></a>    <span class="k">elif</span> <span class="n">total_nested</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="OEPlacement-243"><a href="#OEPlacement-243"><span class="linenos">243</span></a>        <span class="n">OpticalChain</span> <span class="o">=</span> <span class="n">_singleOEPlacement</span><span class="p">(</span>
</span><span id="OEPlacement-244"><a href="#OEPlacement-244"><span class="linenos">244</span></a>            <span class="n">SourceProperties</span><span class="p">,</span> <span class="n">OpticsList</span><span class="p">,</span> <span class="n">DistanceList</span><span class="p">,</span> <span class="n">IncidenceAngleList</span><span class="p">,</span> <span class="n">IncidencePlaneAngleList</span><span class="p">,</span> <span class="n">Description</span>
</span><span id="OEPlacement-245"><a href="#OEPlacement-245"><span class="linenos">245</span></a>        <span class="p">)</span>  <span class="c1"># all simple</span>
</span><span id="OEPlacement-246"><a href="#OEPlacement-246"><span class="linenos">246</span></a>        
</span><span id="OEPlacement-247"><a href="#OEPlacement-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="n">OpticalChain</span>
</span></pre></div>


            <div class="docstring"><p>Automatically place optical elements in the "lab frame" according to given distances and incidence angles.
Outputs an OpticalChain-object.</p>

<p>The source is placed at the origin, and points into the x-direction. The optical elements then follow.</p>

<p>As long as the angles in IncidencePlaneAngleList are 0, the incidence plane remains the x-z plane, i.e.
the optical elements are rotated about the y-axis to set the desired incidence angle between OE-normal
and the direction of incidence of the incoming ray-bundle. Otherwise, the incidence plane gets rotated.</p>

<p>One of the elements of one of the lists 'DistanceList', 'IncidenceAngleList', or 'IncidencePlaneAngleList'
can be a list or a numpy-array. In that case, a list of OpticalChain-objects is created which can be looped over.</p>

<h2 id="parameters">Parameters</h2>

<pre><code>SourceProperties : dict
    Dictionary with the keys "Divergence" :float, "SourceSize" :float,
    "NumberRays" :int, and "Wavelength" :float.
    This determines the source ray-bundle that is created.

OpticsList : list[Optics-class-objects (Mirorrs or Masks)]
    List of Optics-objects.

DistanceList : list[float]
    List of distances, in mm,  at which place the optics out of the
    OpticsList from the precending one. For the first optic, this is
    the distance from the light source.

    One of the elements can ne a list or a numpy-array instead of a float.
    In that case, a list of OpticalChain-objects is created which can be looped over.

IncidenceAngleList : list[float]
    List of incidence angles, in degrees, measured between the central ray
    of the incident ray bundle and the normal on the optical element.

    One of the elements can ne a list or a numpy-array instead of a float.
    In that case, a list of OpticalChain-objects is created which can be looped over.

IncidencePlaneAngleList : list[float], optional
    List of angles, in degrees, by which the incidence plane is rotated
    on the optical element with respect to that on the preceding one.
    Consequently, for the first element, this angle has no qualitative effect.

    One of the elements can ne a list or a numpy-array instead of a float.
    In that case, a list of OpticalChain-objects is created which can be looped over.

Description : str, optional
    A string to describe the optical setup.
</code></pre>

<h2 id="returns">Returns</h2>

<pre><code>OpticalChainList : list[OpticalChain-object]

or

OpticalChain : OpticalChain-object
</code></pre>
</div>


                </section>
                <section id="RayTracingCalculation">
                            <input id="RayTracingCalculation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">RayTracingCalculation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">source_rays</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="ModuleOpticalRay.html#Ray">ARTcore.ModuleOpticalRay.Ray</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">optical_elements</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="ModuleOpticalElement.html#OpticalElement">ARTcore.ModuleOpticalElement.OpticalElement</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">IgnoreDefects</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n"><a href="ModuleOpticalRay.html#Ray">ARTcore.ModuleOpticalRay.Ray</a></span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="RayTracingCalculation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#RayTracingCalculation"></a>
            <div class="chroma pdoc-code"><pre><span></span><span id="RayTracingCalculation-251"><a href="#RayTracingCalculation-251"><span class="linenos">251</span></a><span class="k">def</span> <span class="nf">RayTracingCalculation</span><span class="p">(</span>
</span><span id="RayTracingCalculation-252"><a href="#RayTracingCalculation-252"><span class="linenos">252</span></a>    <span class="n">source_rays</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">mray</span><span class="o">.</span><span class="n">Ray</span><span class="p">],</span> <span class="n">optical_elements</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">moe</span><span class="o">.</span><span class="n">OpticalElement</span><span class="p">],</span> <span class="n">IgnoreDefects</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="RayTracingCalculation-253"><a href="#RayTracingCalculation-253"><span class="linenos">253</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">mray</span><span class="o">.</span><span class="n">Ray</span><span class="p">]]:</span>
</span><span id="RayTracingCalculation-254"><a href="#RayTracingCalculation-254"><span class="linenos">254</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="RayTracingCalculation-255"><a href="#RayTracingCalculation-255"><span class="linenos">255</span></a><span class="sd">    The actual ray-tracing calculation, starting from the list of &#39;source_rays&#39;,</span>
</span><span id="RayTracingCalculation-256"><a href="#RayTracingCalculation-256"><span class="linenos">256</span></a><span class="sd">    and propagating them from one optical element to the next in the order of the</span>
</span><span id="RayTracingCalculation-257"><a href="#RayTracingCalculation-257"><span class="linenos">257</span></a><span class="sd">    items of the list &#39;optical_elements&#39;.</span>
</span><span id="RayTracingCalculation-258"><a href="#RayTracingCalculation-258"><span class="linenos">258</span></a>
</span><span id="RayTracingCalculation-259"><a href="#RayTracingCalculation-259"><span class="linenos">259</span></a>
</span><span id="RayTracingCalculation-260"><a href="#RayTracingCalculation-260"><span class="linenos">260</span></a><span class="sd">    Parameters</span>
</span><span id="RayTracingCalculation-261"><a href="#RayTracingCalculation-261"><span class="linenos">261</span></a><span class="sd">    ----------</span>
</span><span id="RayTracingCalculation-262"><a href="#RayTracingCalculation-262"><span class="linenos">262</span></a><span class="sd">        source_rays : list[Ray-objects]</span>
</span><span id="RayTracingCalculation-263"><a href="#RayTracingCalculation-263"><span class="linenos">263</span></a><span class="sd">            List of input rays.</span>
</span><span id="RayTracingCalculation-264"><a href="#RayTracingCalculation-264"><span class="linenos">264</span></a>
</span><span id="RayTracingCalculation-265"><a href="#RayTracingCalculation-265"><span class="linenos">265</span></a><span class="sd">        optical_elements : list[OpticalElement-objects]</span>
</span><span id="RayTracingCalculation-266"><a href="#RayTracingCalculation-266"><span class="linenos">266</span></a>
</span><span id="RayTracingCalculation-267"><a href="#RayTracingCalculation-267"><span class="linenos">267</span></a>
</span><span id="RayTracingCalculation-268"><a href="#RayTracingCalculation-268"><span class="linenos">268</span></a><span class="sd">    Returns</span>
</span><span id="RayTracingCalculation-269"><a href="#RayTracingCalculation-269"><span class="linenos">269</span></a><span class="sd">    -------</span>
</span><span id="RayTracingCalculation-270"><a href="#RayTracingCalculation-270"><span class="linenos">270</span></a><span class="sd">        output_rays : list[list[Ray-objects]]</span>
</span><span id="RayTracingCalculation-271"><a href="#RayTracingCalculation-271"><span class="linenos">271</span></a><span class="sd">            List of lists of rays, each item corresponding to the ray-bundle *after*</span>
</span><span id="RayTracingCalculation-272"><a href="#RayTracingCalculation-272"><span class="linenos">272</span></a><span class="sd">            the item with the same index in the &#39;optical_elements&#39;-list.</span>
</span><span id="RayTracingCalculation-273"><a href="#RayTracingCalculation-273"><span class="linenos">273</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="RayTracingCalculation-274"><a href="#RayTracingCalculation-274"><span class="linenos">274</span></a>    <span class="n">ez</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="RayTracingCalculation-275"><a href="#RayTracingCalculation-275"><span class="linenos">275</span></a>    <span class="n">ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="RayTracingCalculation-276"><a href="#RayTracingCalculation-276"><span class="linenos">276</span></a>    <span class="n">output_rays</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="RayTracingCalculation-277"><a href="#RayTracingCalculation-277"><span class="linenos">277</span></a>
</span><span id="RayTracingCalculation-278"><a href="#RayTracingCalculation-278"><span class="linenos">278</span></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">optical_elements</span><span class="p">)):</span>
</span><span id="RayTracingCalculation-279"><a href="#RayTracingCalculation-279"><span class="linenos">279</span></a>        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="RayTracingCalculation-280"><a href="#RayTracingCalculation-280"><span class="linenos">280</span></a>            <span class="n">RayList</span> <span class="o">=</span> <span class="n">source_rays</span>
</span><span id="RayTracingCalculation-281"><a href="#RayTracingCalculation-281"><span class="linenos">281</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RayTracingCalculation-282"><a href="#RayTracingCalculation-282"><span class="linenos">282</span></a>            <span class="n">RayList</span> <span class="o">=</span> <span class="n">output_rays</span><span class="p">[</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="RayTracingCalculation-283"><a href="#RayTracingCalculation-283"><span class="linenos">283</span></a>
</span><span id="RayTracingCalculation-284"><a href="#RayTracingCalculation-284"><span class="linenos">284</span></a>        <span class="c1"># Mirror = optical_elements[k].type</span>
</span><span id="RayTracingCalculation-285"><a href="#RayTracingCalculation-285"><span class="linenos">285</span></a>        <span class="n">Position</span> <span class="o">=</span> <span class="n">optical_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">position</span>
</span><span id="RayTracingCalculation-286"><a href="#RayTracingCalculation-286"><span class="linenos">286</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">optical_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">normal</span>
</span><span id="RayTracingCalculation-287"><a href="#RayTracingCalculation-287"><span class="linenos">287</span></a>        <span class="n">m</span> <span class="o">=</span> <span class="n">optical_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">majoraxis</span>
</span><span id="RayTracingCalculation-288"><a href="#RayTracingCalculation-288"><span class="linenos">288</span></a>
</span><span id="RayTracingCalculation-289"><a href="#RayTracingCalculation-289"><span class="linenos">289</span></a>        <span class="c1"># transform rays into mirror coordinate system</span>
</span><span id="RayTracingCalculation-290"><a href="#RayTracingCalculation-290"><span class="linenos">290</span></a>        <span class="n">RayList</span> <span class="o">=</span> <span class="n">mgeo</span><span class="o">.</span><span class="n">TranslationRayList</span><span class="p">(</span><span class="n">RayList</span><span class="p">,</span> <span class="o">-</span><span class="n">Position</span><span class="p">)</span>
</span><span id="RayTracingCalculation-291"><a href="#RayTracingCalculation-291"><span class="linenos">291</span></a>        <span class="n">RayList</span> <span class="o">=</span> <span class="n">mgeo</span><span class="o">.</span><span class="n">RotationRayList</span><span class="p">(</span><span class="n">RayList</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ez</span><span class="p">)</span>
</span><span id="RayTracingCalculation-292"><a href="#RayTracingCalculation-292"><span class="linenos">292</span></a>        <span class="c1"># FIRST rotate m in the same way as you just did the ray list,</span>
</span><span id="RayTracingCalculation-293"><a href="#RayTracingCalculation-293"><span class="linenos">293</span></a>        <span class="c1"># THEN rotate the rays again to match the NEW m with the x-axis !</span>
</span><span id="RayTracingCalculation-294"><a href="#RayTracingCalculation-294"><span class="linenos">294</span></a>        <span class="n">mPrime</span> <span class="o">=</span> <span class="n">mgeo</span><span class="o">.</span><span class="n">RotationPoint</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ez</span><span class="p">)</span>
</span><span id="RayTracingCalculation-295"><a href="#RayTracingCalculation-295"><span class="linenos">295</span></a>        <span class="n">RayList</span> <span class="o">=</span> <span class="n">mgeo</span><span class="o">.</span><span class="n">RotationRayList</span><span class="p">(</span><span class="n">RayList</span><span class="p">,</span> <span class="n">mPrime</span><span class="p">,</span> <span class="n">ex</span><span class="p">)</span>
</span><span id="RayTracingCalculation-296"><a href="#RayTracingCalculation-296"><span class="linenos">296</span></a>        <span class="n">RayList</span> <span class="o">=</span> <span class="n">mgeo</span><span class="o">.</span><span class="n">TranslationRayList</span><span class="p">(</span><span class="n">RayList</span><span class="p">,</span> <span class="n">optical_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">get_centre</span><span class="p">())</span>
</span><span id="RayTracingCalculation-297"><a href="#RayTracingCalculation-297"><span class="linenos">297</span></a>
</span><span id="RayTracingCalculation-298"><a href="#RayTracingCalculation-298"><span class="linenos">298</span></a>        <span class="c1"># optical element acts on the rays:</span>
</span><span id="RayTracingCalculation-299"><a href="#RayTracingCalculation-299"><span class="linenos">299</span></a>        <span class="k">if</span> <span class="s2">&quot;Mirror&quot;</span> <span class="ow">in</span> <span class="n">optical_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">type</span><span class="p">:</span>
</span><span id="RayTracingCalculation-300"><a href="#RayTracingCalculation-300"><span class="linenos">300</span></a>            <span class="n">RayList</span> <span class="o">=</span> <span class="n">mmirror</span><span class="o">.</span><span class="n">ReflectionMirrorRayList</span><span class="p">(</span><span class="n">optical_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">RayList</span><span class="p">,</span> <span class="n">IgnoreDefects</span> <span class="o">=</span> <span class="n">IgnoreDefects</span><span class="p">)</span>
</span><span id="RayTracingCalculation-301"><a href="#RayTracingCalculation-301"><span class="linenos">301</span></a>        <span class="k">elif</span> <span class="n">optical_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s2">&quot;Mask&quot;</span><span class="p">:</span>
</span><span id="RayTracingCalculation-302"><a href="#RayTracingCalculation-302"><span class="linenos">302</span></a>            <span class="n">RayList</span> <span class="o">=</span> <span class="n">mmask</span><span class="o">.</span><span class="n">TransmitMaskRayList</span><span class="p">(</span><span class="n">optical_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">RayList</span><span class="p">)</span>
</span><span id="RayTracingCalculation-303"><a href="#RayTracingCalculation-303"><span class="linenos">303</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="RayTracingCalculation-304"><a href="#RayTracingCalculation-304"><span class="linenos">304</span></a>            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s2">&quot;I don`t recognize the type of optical element &quot;</span> <span class="o">+</span> <span class="n">optical_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">type</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="RayTracingCalculation-305"><a href="#RayTracingCalculation-305"><span class="linenos">305</span></a>
</span><span id="RayTracingCalculation-306"><a href="#RayTracingCalculation-306"><span class="linenos">306</span></a>        <span class="c1"># transform new rays back into &quot;lab frame&quot;</span>
</span><span id="RayTracingCalculation-307"><a href="#RayTracingCalculation-307"><span class="linenos">307</span></a>        <span class="n">RayList</span> <span class="o">=</span> <span class="n">mgeo</span><span class="o">.</span><span class="n">TranslationRayList</span><span class="p">(</span><span class="n">RayList</span><span class="p">,</span> <span class="o">-</span><span class="n">optical_elements</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">get_centre</span><span class="p">())</span>
</span><span id="RayTracingCalculation-308"><a href="#RayTracingCalculation-308"><span class="linenos">308</span></a>        <span class="n">RayList</span> <span class="o">=</span> <span class="n">mgeo</span><span class="o">.</span><span class="n">RotationRayList</span><span class="p">(</span><span class="n">RayList</span><span class="p">,</span> <span class="n">ex</span><span class="p">,</span> <span class="n">mPrime</span><span class="p">)</span>
</span><span id="RayTracingCalculation-309"><a href="#RayTracingCalculation-309"><span class="linenos">309</span></a>        <span class="n">RayList</span> <span class="o">=</span> <span class="n">mgeo</span><span class="o">.</span><span class="n">RotationRayList</span><span class="p">(</span><span class="n">RayList</span><span class="p">,</span> <span class="n">ez</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="RayTracingCalculation-310"><a href="#RayTracingCalculation-310"><span class="linenos">310</span></a>        <span class="n">RayList</span> <span class="o">=</span> <span class="n">mgeo</span><span class="o">.</span><span class="n">TranslationRayList</span><span class="p">(</span><span class="n">RayList</span><span class="p">,</span> <span class="n">Position</span><span class="p">)</span>
</span><span id="RayTracingCalculation-311"><a href="#RayTracingCalculation-311"><span class="linenos">311</span></a>
</span><span id="RayTracingCalculation-312"><a href="#RayTracingCalculation-312"><span class="linenos">312</span></a>        <span class="n">output_rays</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RayList</span><span class="p">)</span>
</span><span id="RayTracingCalculation-313"><a href="#RayTracingCalculation-313"><span class="linenos">313</span></a>
</span><span id="RayTracingCalculation-314"><a href="#RayTracingCalculation-314"><span class="linenos">314</span></a>    <span class="k">return</span> <span class="n">output_rays</span>
</span></pre></div>


            <div class="docstring"><p>The actual ray-tracing calculation, starting from the list of 'source_rays',
and propagating them from one optical element to the next in the order of the
items of the list 'optical_elements'.</p>

<h2 id="parameters">Parameters</h2>

<pre><code>source_rays : list[Ray-objects]
    List of input rays.

optical_elements : list[OpticalElement-objects]
</code></pre>

<h2 id="returns">Returns</h2>

<pre><code>output_rays : list[list[Ray-objects]]
    List of lists of rays, each item corresponding to the ray-bundle *after*
    the item with the same index in the 'optical_elements'-list.
</code></pre>
</div>


                </section>
                <section id="FindOptimalDistance">
                            <input id="FindOptimalDistance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">FindOptimalDistance</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">Detector</span>,</span><span class="param">	<span class="n">RayList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="ModuleOpticalRay.html#Ray">ARTcore.ModuleOpticalRay.Ray</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">OptFor</span><span class="o">=</span><span class="s1">&#39;intensity&#39;</span>,</span><span class="param">	<span class="n">Amplitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">Precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>,</span><span class="param">	<span class="n">IntensityWeighted</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FindOptimalDistance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FindOptimalDistance"></a>
            <div class="chroma pdoc-code"><pre><span></span><span id="FindOptimalDistance-370"><a href="#FindOptimalDistance-370"><span class="linenos">370</span></a><span class="k">def</span> <span class="nf">FindOptimalDistance</span><span class="p">(</span>
</span><span id="FindOptimalDistance-371"><a href="#FindOptimalDistance-371"><span class="linenos">371</span></a>    <span class="n">Detector</span><span class="p">,</span>
</span><span id="FindOptimalDistance-372"><a href="#FindOptimalDistance-372"><span class="linenos">372</span></a>    <span class="n">RayList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">mray</span><span class="o">.</span><span class="n">Ray</span><span class="p">],</span>
</span><span id="FindOptimalDistance-373"><a href="#FindOptimalDistance-373"><span class="linenos">373</span></a>    <span class="n">OptFor</span><span class="o">=</span><span class="s2">&quot;intensity&quot;</span><span class="p">,</span>
</span><span id="FindOptimalDistance-374"><a href="#FindOptimalDistance-374"><span class="linenos">374</span></a>    <span class="n">Amplitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FindOptimalDistance-375"><a href="#FindOptimalDistance-375"><span class="linenos">375</span></a>    <span class="n">Precision</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="FindOptimalDistance-376"><a href="#FindOptimalDistance-376"><span class="linenos">376</span></a>    <span class="n">IntensityWeighted</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="FindOptimalDistance-377"><a href="#FindOptimalDistance-377"><span class="linenos">377</span></a>    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="FindOptimalDistance-378"><a href="#FindOptimalDistance-378"><span class="linenos">378</span></a><span class="p">):</span>
</span><span id="FindOptimalDistance-379"><a href="#FindOptimalDistance-379"><span class="linenos">379</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FindOptimalDistance-380"><a href="#FindOptimalDistance-380"><span class="linenos">380</span></a><span class="sd">    Automatically finds the optimal the &#39;Detector&#39;-distance for either</span>
</span><span id="FindOptimalDistance-381"><a href="#FindOptimalDistance-381"><span class="linenos">381</span></a><span class="sd">    maximum intensity, or minimal spotsize or duration.</span>
</span><span id="FindOptimalDistance-382"><a href="#FindOptimalDistance-382"><span class="linenos">382</span></a>
</span><span id="FindOptimalDistance-383"><a href="#FindOptimalDistance-383"><span class="linenos">383</span></a><span class="sd">    Parameters</span>
</span><span id="FindOptimalDistance-384"><a href="#FindOptimalDistance-384"><span class="linenos">384</span></a><span class="sd">    ----------</span>
</span><span id="FindOptimalDistance-385"><a href="#FindOptimalDistance-385"><span class="linenos">385</span></a><span class="sd">        Detector : Detector-object</span>
</span><span id="FindOptimalDistance-386"><a href="#FindOptimalDistance-386"><span class="linenos">386</span></a>
</span><span id="FindOptimalDistance-387"><a href="#FindOptimalDistance-387"><span class="linenos">387</span></a><span class="sd">        RayList : list[Ray-objects]</span>
</span><span id="FindOptimalDistance-388"><a href="#FindOptimalDistance-388"><span class="linenos">388</span></a>
</span><span id="FindOptimalDistance-389"><a href="#FindOptimalDistance-389"><span class="linenos">389</span></a><span class="sd">        OptFor : str, optional</span>
</span><span id="FindOptimalDistance-390"><a href="#FindOptimalDistance-390"><span class="linenos">390</span></a><span class="sd">            &quot;spotsize&quot;: minimizes the standard-deviation spot size *d* on the detector.</span>
</span><span id="FindOptimalDistance-391"><a href="#FindOptimalDistance-391"><span class="linenos">391</span></a><span class="sd">            &quot;duration&quot;: minimizes the standard-deviation *tau* of the ray-delays.</span>
</span><span id="FindOptimalDistance-392"><a href="#FindOptimalDistance-392"><span class="linenos">392</span></a><span class="sd">            &quot;intensity&quot;: Maximizes 1/tau/d^2.</span>
</span><span id="FindOptimalDistance-393"><a href="#FindOptimalDistance-393"><span class="linenos">393</span></a><span class="sd">            Defaults to &quot;intensity&quot;.</span>
</span><span id="FindOptimalDistance-394"><a href="#FindOptimalDistance-394"><span class="linenos">394</span></a>
</span><span id="FindOptimalDistance-395"><a href="#FindOptimalDistance-395"><span class="linenos">395</span></a><span class="sd">        Amplitude : float, optional</span>
</span><span id="FindOptimalDistance-396"><a href="#FindOptimalDistance-396"><span class="linenos">396</span></a><span class="sd">            The detector-distances within which the optimization is done will be</span>
</span><span id="FindOptimalDistance-397"><a href="#FindOptimalDistance-397"><span class="linenos">397</span></a><span class="sd">            the distance of &#39;Detector&#39; +/- Amplitude in mm.</span>
</span><span id="FindOptimalDistance-398"><a href="#FindOptimalDistance-398"><span class="linenos">398</span></a>
</span><span id="FindOptimalDistance-399"><a href="#FindOptimalDistance-399"><span class="linenos">399</span></a><span class="sd">        Precision : int, optional</span>
</span><span id="FindOptimalDistance-400"><a href="#FindOptimalDistance-400"><span class="linenos">400</span></a><span class="sd">            Precision-parameter for the search algorithm. For Precision = n,</span>
</span><span id="FindOptimalDistance-401"><a href="#FindOptimalDistance-401"><span class="linenos">401</span></a><span class="sd">            it will iterate with search amplitudes decreasing until 10^{-n}.</span>
</span><span id="FindOptimalDistance-402"><a href="#FindOptimalDistance-402"><span class="linenos">402</span></a><span class="sd">            Defaults to 3.</span>
</span><span id="FindOptimalDistance-403"><a href="#FindOptimalDistance-403"><span class="linenos">403</span></a>
</span><span id="FindOptimalDistance-404"><a href="#FindOptimalDistance-404"><span class="linenos">404</span></a><span class="sd">        IntensityWeighted : bool, optional</span>
</span><span id="FindOptimalDistance-405"><a href="#FindOptimalDistance-405"><span class="linenos">405</span></a><span class="sd">            Whether to weigh the calculation of spotsize and/or duration by the ray-intensities.</span>
</span><span id="FindOptimalDistance-406"><a href="#FindOptimalDistance-406"><span class="linenos">406</span></a><span class="sd">            Defaults to False.</span>
</span><span id="FindOptimalDistance-407"><a href="#FindOptimalDistance-407"><span class="linenos">407</span></a>
</span><span id="FindOptimalDistance-408"><a href="#FindOptimalDistance-408"><span class="linenos">408</span></a><span class="sd">        verbose : bool, optional</span>
</span><span id="FindOptimalDistance-409"><a href="#FindOptimalDistance-409"><span class="linenos">409</span></a><span class="sd">            Whether to print results to the console.</span>
</span><span id="FindOptimalDistance-410"><a href="#FindOptimalDistance-410"><span class="linenos">410</span></a>
</span><span id="FindOptimalDistance-411"><a href="#FindOptimalDistance-411"><span class="linenos">411</span></a><span class="sd">    Returns</span>
</span><span id="FindOptimalDistance-412"><a href="#FindOptimalDistance-412"><span class="linenos">412</span></a><span class="sd">    -------</span>
</span><span id="FindOptimalDistance-413"><a href="#FindOptimalDistance-413"><span class="linenos">413</span></a><span class="sd">        OptDetector : Detector-object</span>
</span><span id="FindOptimalDistance-414"><a href="#FindOptimalDistance-414"><span class="linenos">414</span></a><span class="sd">            A new detector-instance with optimized distance.</span>
</span><span id="FindOptimalDistance-415"><a href="#FindOptimalDistance-415"><span class="linenos">415</span></a>
</span><span id="FindOptimalDistance-416"><a href="#FindOptimalDistance-416"><span class="linenos">416</span></a><span class="sd">        OptSpotSize : float</span>
</span><span id="FindOptimalDistance-417"><a href="#FindOptimalDistance-417"><span class="linenos">417</span></a><span class="sd">            Spotsize, calculated as standard deviation in mm of the spot-diagram</span>
</span><span id="FindOptimalDistance-418"><a href="#FindOptimalDistance-418"><span class="linenos">418</span></a><span class="sd">            on the optimized detector.</span>
</span><span id="FindOptimalDistance-419"><a href="#FindOptimalDistance-419"><span class="linenos">419</span></a>
</span><span id="FindOptimalDistance-420"><a href="#FindOptimalDistance-420"><span class="linenos">420</span></a><span class="sd">        OptDuration : float</span>
</span><span id="FindOptimalDistance-421"><a href="#FindOptimalDistance-421"><span class="linenos">421</span></a><span class="sd">            Duration, calculated as standard deviation in fs of the ray-delays</span>
</span><span id="FindOptimalDistance-422"><a href="#FindOptimalDistance-422"><span class="linenos">422</span></a><span class="sd">            on the optimized detector.</span>
</span><span id="FindOptimalDistance-423"><a href="#FindOptimalDistance-423"><span class="linenos">423</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FindOptimalDistance-424"><a href="#FindOptimalDistance-424"><span class="linenos">424</span></a>
</span><span id="FindOptimalDistance-425"><a href="#FindOptimalDistance-425"><span class="linenos">425</span></a>    <span class="k">if</span> <span class="n">OptFor</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;intensity&quot;</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">]:</span>
</span><span id="FindOptimalDistance-426"><a href="#FindOptimalDistance-426"><span class="linenos">426</span></a>        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span>
</span><span id="FindOptimalDistance-427"><a href="#FindOptimalDistance-427"><span class="linenos">427</span></a>            <span class="s2">&quot;I don`t recognize what you want to optimize the detector distance for. OptFor must be either &#39;intensity&#39;, &#39;size&#39; or &#39;duration&#39;.&quot;</span>
</span><span id="FindOptimalDistance-428"><a href="#FindOptimalDistance-428"><span class="linenos">428</span></a>        <span class="p">)</span>
</span><span id="FindOptimalDistance-429"><a href="#FindOptimalDistance-429"><span class="linenos">429</span></a>
</span><span id="FindOptimalDistance-430"><a href="#FindOptimalDistance-430"><span class="linenos">430</span></a>    <span class="n">FirstDistance</span> <span class="o">=</span> <span class="n">Detector</span><span class="o">.</span><span class="n">get_distance</span><span class="p">()</span>
</span><span id="FindOptimalDistance-431"><a href="#FindOptimalDistance-431"><span class="linenos">431</span></a>    <span class="n">ListPointDetector2DCentre</span> <span class="o">=</span> <span class="n">Detector</span><span class="o">.</span><span class="n">get_PointList2DCentre</span><span class="p">(</span><span class="n">RayList</span><span class="p">)</span>
</span><span id="FindOptimalDistance-432"><a href="#FindOptimalDistance-432"><span class="linenos">432</span></a>    <span class="n">SizeSpot</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">StandardDeviation</span><span class="p">(</span><span class="n">ListPointDetector2DCentre</span><span class="p">)</span>
</span><span id="FindOptimalDistance-433"><a href="#FindOptimalDistance-433"><span class="linenos">433</span></a>    <span class="n">NumericalAperture</span> <span class="o">=</span> <span class="n">ReturnNumericalAperture</span><span class="p">(</span><span class="n">RayList</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="FindOptimalDistance-434"><a href="#FindOptimalDistance-434"><span class="linenos">434</span></a>    <span class="k">if</span> <span class="n">Amplitude</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FindOptimalDistance-435"><a href="#FindOptimalDistance-435"><span class="linenos">435</span></a>        <span class="n">Amplitude</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">SizeSpot</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">NumericalAperture</span><span class="p">))),</span> <span class="n">FirstDistance</span><span class="p">)</span>
</span><span id="FindOptimalDistance-436"><a href="#FindOptimalDistance-436"><span class="linenos">436</span></a>    <span class="n">Step</span> <span class="o">=</span> <span class="n">Amplitude</span><span class="o">/</span><span class="mi">10</span>
</span><span id="FindOptimalDistance-437"><a href="#FindOptimalDistance-437"><span class="linenos">437</span></a>    <span class="c1">#Step = Amplitude / 5  # pretty good in half the time ;-)</span>
</span><span id="FindOptimalDistance-438"><a href="#FindOptimalDistance-438"><span class="linenos">438</span></a>
</span><span id="FindOptimalDistance-439"><a href="#FindOptimalDistance-439"><span class="linenos">439</span></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
</span><span id="FindOptimalDistance-440"><a href="#FindOptimalDistance-440"><span class="linenos">440</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="FindOptimalDistance-441"><a href="#FindOptimalDistance-441"><span class="linenos">441</span></a>            <span class="sa">f</span><span class="s2">&quot;Searching optimal detector position for *</span><span class="si">{</span><span class="n">OptFor</span><span class="si">}</span><span class="s2">* within [</span><span class="si">{</span><span class="n">FirstDistance</span><span class="o">-</span><span class="n">Amplitude</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">FirstDistance</span><span class="o">+</span><span class="n">Amplitude</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">] mm...&quot;</span><span class="p">,</span>
</span><span id="FindOptimalDistance-442"><a href="#FindOptimalDistance-442"><span class="linenos">442</span></a>            <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="FindOptimalDistance-443"><a href="#FindOptimalDistance-443"><span class="linenos">443</span></a>            <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="FindOptimalDistance-444"><a href="#FindOptimalDistance-444"><span class="linenos">444</span></a>        <span class="p">)</span>
</span><span id="FindOptimalDistance-445"><a href="#FindOptimalDistance-445"><span class="linenos">445</span></a>    <span class="n">movingDetector</span> <span class="o">=</span> <span class="n">Detector</span><span class="o">.</span><span class="n">copy_detector</span><span class="p">()</span>
</span><span id="FindOptimalDistance-446"><a href="#FindOptimalDistance-446"><span class="linenos">446</span></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Precision</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="FindOptimalDistance-447"><a href="#FindOptimalDistance-447"><span class="linenos">447</span></a>        <span class="n">movingDetector</span><span class="p">,</span> <span class="n">OptSpotSize</span><span class="p">,</span> <span class="n">OptDuration</span> <span class="o">=</span> <span class="n">_FindOptimalDistanceBIS</span><span class="p">(</span>
</span><span id="FindOptimalDistance-448"><a href="#FindOptimalDistance-448"><span class="linenos">448</span></a>            <span class="n">movingDetector</span><span class="p">,</span> <span class="n">Amplitude</span> <span class="o">*</span> <span class="mf">0.1</span><span class="o">**</span><span class="n">k</span><span class="p">,</span> <span class="n">Step</span> <span class="o">*</span> <span class="mf">0.1</span><span class="o">**</span><span class="n">k</span><span class="p">,</span> <span class="n">RayList</span><span class="p">,</span> <span class="n">OptFor</span><span class="p">,</span> <span class="n">IntensityWeighted</span>
</span><span id="FindOptimalDistance-449"><a href="#FindOptimalDistance-449"><span class="linenos">449</span></a>        <span class="p">)</span>
</span><span id="FindOptimalDistance-450"><a href="#FindOptimalDistance-450"><span class="linenos">450</span></a>
</span><span id="FindOptimalDistance-451"><a href="#FindOptimalDistance-451"><span class="linenos">451</span></a>    <span class="k">if</span> <span class="p">(</span>
</span><span id="FindOptimalDistance-452"><a href="#FindOptimalDistance-452"><span class="linenos">452</span></a>        <span class="ow">not</span> <span class="n">FirstDistance</span> <span class="o">-</span> <span class="n">Amplitude</span> <span class="o">+</span> <span class="mi">10</span><span class="o">**-</span><span class="n">Precision</span>
</span><span id="FindOptimalDistance-453"><a href="#FindOptimalDistance-453"><span class="linenos">453</span></a>        <span class="o">&lt;</span> <span class="n">movingDetector</span><span class="o">.</span><span class="n">get_distance</span><span class="p">()</span>
</span><span id="FindOptimalDistance-454"><a href="#FindOptimalDistance-454"><span class="linenos">454</span></a>        <span class="o">&lt;</span> <span class="n">FirstDistance</span> <span class="o">+</span> <span class="n">Amplitude</span> <span class="o">-</span> <span class="mi">10</span><span class="o">**-</span><span class="n">Precision</span>
</span><span id="FindOptimalDistance-455"><a href="#FindOptimalDistance-455"><span class="linenos">455</span></a>    <span class="p">):</span>
</span><span id="FindOptimalDistance-456"><a href="#FindOptimalDistance-456"><span class="linenos">456</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There`s no minimum-size/duration focus in the searched range.&quot;</span><span class="p">)</span>
</span><span id="FindOptimalDistance-457"><a href="#FindOptimalDistance-457"><span class="linenos">457</span></a>
</span><span id="FindOptimalDistance-458"><a href="#FindOptimalDistance-458"><span class="linenos">458</span></a>    <span class="nb">print</span><span class="p">(</span>
</span><span id="FindOptimalDistance-459"><a href="#FindOptimalDistance-459"><span class="linenos">459</span></a>        <span class="s2">&quot;</span><span class="se">\r\033</span><span class="s2">[K&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span>
</span><span id="FindOptimalDistance-460"><a href="#FindOptimalDistance-460"><span class="linenos">460</span></a>    <span class="p">)</span>  <span class="c1"># move to beginning of the line with \r and then delete the whole line with \033[K</span>
</span><span id="FindOptimalDistance-461"><a href="#FindOptimalDistance-461"><span class="linenos">461</span></a>    <span class="k">return</span> <span class="n">movingDetector</span><span class="p">,</span> <span class="n">OptSpotSize</span><span class="p">,</span> <span class="n">OptDuration</span>
</span></pre></div>


            <div class="docstring"><p>Automatically finds the optimal the 'Detector'-distance for either
maximum intensity, or minimal spotsize or duration.</p>

<h2 id="parameters">Parameters</h2>

<pre><code>Detector : Detector-object

RayList : list[Ray-objects]

OptFor : str, optional
    "spotsize": minimizes the standard-deviation spot size *d* on the detector.
    "duration": minimizes the standard-deviation *tau* of the ray-delays.
    "intensity": Maximizes 1/tau/d^2.
    Defaults to "intensity".

Amplitude : float, optional
    The detector-distances within which the optimization is done will be
    the distance of 'Detector' +/- Amplitude in mm.

Precision : int, optional
    Precision-parameter for the search algorithm. For Precision = n,
    it will iterate with search amplitudes decreasing until 10^{-n}.
    Defaults to 3.

IntensityWeighted : bool, optional
    Whether to weigh the calculation of spotsize and/or duration by the ray-intensities.
    Defaults to False.

verbose : bool, optional
    Whether to print results to the console.
</code></pre>

<h2 id="returns">Returns</h2>

<pre><code>OptDetector : Detector-object
    A new detector-instance with optimized distance.

OptSpotSize : float
    Spotsize, calculated as standard deviation in mm of the spot-diagram
    on the optimized detector.

OptDuration : float
    Duration, calculated as standard deviation in fs of the ray-delays
    on the optimized detector.
</code></pre>
</div>


                </section>
                <section id="FindCentralRay">
                            <input id="FindCentralRay-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">FindCentralRay</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">RayList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="ModuleOpticalRay.html#Ray">ARTcore.ModuleOpticalRay.Ray</a></span><span class="p">]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FindCentralRay-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FindCentralRay"></a>
            <div class="chroma pdoc-code"><pre><span></span><span id="FindCentralRay-465"><a href="#FindCentralRay-465"><span class="linenos">465</span></a><span class="k">def</span> <span class="nf">FindCentralRay</span><span class="p">(</span><span class="n">RayList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">mray</span><span class="o">.</span><span class="n">Ray</span><span class="p">]):</span>
</span><span id="FindCentralRay-466"><a href="#FindCentralRay-466"><span class="linenos">466</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FindCentralRay-467"><a href="#FindCentralRay-467"><span class="linenos">467</span></a><span class="sd">    Out of a the list of Ray-objects, RayList, determine the average direction</span>
</span><span id="FindCentralRay-468"><a href="#FindCentralRay-468"><span class="linenos">468</span></a><span class="sd">    vector and source point, and the return a Ray-object representing this </span>
</span><span id="FindCentralRay-469"><a href="#FindCentralRay-469"><span class="linenos">469</span></a><span class="sd">    central ray of the RayList.</span>
</span><span id="FindCentralRay-470"><a href="#FindCentralRay-470"><span class="linenos">470</span></a><span class="sd">    </span>
</span><span id="FindCentralRay-471"><a href="#FindCentralRay-471"><span class="linenos">471</span></a><span class="sd">    Parameters</span>
</span><span id="FindCentralRay-472"><a href="#FindCentralRay-472"><span class="linenos">472</span></a><span class="sd">    ----------</span>
</span><span id="FindCentralRay-473"><a href="#FindCentralRay-473"><span class="linenos">473</span></a><span class="sd">        RayList : list of Ray-objects</span>
</span><span id="FindCentralRay-474"><a href="#FindCentralRay-474"><span class="linenos">474</span></a>
</span><span id="FindCentralRay-475"><a href="#FindCentralRay-475"><span class="linenos">475</span></a><span class="sd">    Returns</span>
</span><span id="FindCentralRay-476"><a href="#FindCentralRay-476"><span class="linenos">476</span></a><span class="sd">    -------</span>
</span><span id="FindCentralRay-477"><a href="#FindCentralRay-477"><span class="linenos">477</span></a><span class="sd">        CentralRay : Ray-object</span>
</span><span id="FindCentralRay-478"><a href="#FindCentralRay-478"><span class="linenos">478</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FindCentralRay-479"><a href="#FindCentralRay-479"><span class="linenos">479</span></a>      
</span><span id="FindCentralRay-480"><a href="#FindCentralRay-480"><span class="linenos">480</span></a>    <span class="n">CentralVector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">vector</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">RayList</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="FindCentralRay-481"><a href="#FindCentralRay-481"><span class="linenos">481</span></a>    <span class="n">CentralPoint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">RayList</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="FindCentralRay-482"><a href="#FindCentralRay-482"><span class="linenos">482</span></a>    
</span><span id="FindCentralRay-483"><a href="#FindCentralRay-483"><span class="linenos">483</span></a>    <span class="k">return</span> <span class="n">mray</span><span class="o">.</span><span class="n">Ray</span><span class="p">(</span><span class="n">CentralPoint</span><span class="p">,</span> <span class="n">CentralVector</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Out of a the list of Ray-objects, RayList, determine the average direction
vector and source point, and the return a Ray-object representing this 
central ray of the RayList.</p>

<h2 id="parameters">Parameters</h2>

<pre><code>RayList : list of Ray-objects
</code></pre>

<h2 id="returns">Returns</h2>

<pre><code>CentralRay : Ray-object
</code></pre>
</div>


                </section>
                <section id="StandardDeviation">
                            <input id="StandardDeviation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">StandardDeviation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">List</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="StandardDeviation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#StandardDeviation"></a>
            <div class="chroma pdoc-code"><pre><span></span><span id="StandardDeviation-486"><a href="#StandardDeviation-486"><span class="linenos">486</span></a><span class="k">def</span> <span class="nf">StandardDeviation</span><span class="p">(</span><span class="n">List</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="StandardDeviation-487"><a href="#StandardDeviation-487"><span class="linenos">487</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="StandardDeviation-488"><a href="#StandardDeviation-488"><span class="linenos">488</span></a><span class="sd">    Return the standard deviation of elements in the supplied list.</span>
</span><span id="StandardDeviation-489"><a href="#StandardDeviation-489"><span class="linenos">489</span></a><span class="sd">    If the elements are floats, it&#39;s simply the root-mean-square over the numbers.</span>
</span><span id="StandardDeviation-490"><a href="#StandardDeviation-490"><span class="linenos">490</span></a><span class="sd">    If the elements are vectors (represented as numpy-arrays), the root-mean-square</span>
</span><span id="StandardDeviation-491"><a href="#StandardDeviation-491"><span class="linenos">491</span></a><span class="sd">    of the distance of the points from their mean is calculated.</span>
</span><span id="StandardDeviation-492"><a href="#StandardDeviation-492"><span class="linenos">492</span></a>
</span><span id="StandardDeviation-493"><a href="#StandardDeviation-493"><span class="linenos">493</span></a><span class="sd">    Parameters</span>
</span><span id="StandardDeviation-494"><a href="#StandardDeviation-494"><span class="linenos">494</span></a><span class="sd">    ----------</span>
</span><span id="StandardDeviation-495"><a href="#StandardDeviation-495"><span class="linenos">495</span></a><span class="sd">        List : list of floats or of np.ndarray</span>
</span><span id="StandardDeviation-496"><a href="#StandardDeviation-496"><span class="linenos">496</span></a><span class="sd">            Numbers (in ART, typically delays)</span>
</span><span id="StandardDeviation-497"><a href="#StandardDeviation-497"><span class="linenos">497</span></a><span class="sd">            or 2D or 3D vectors (in ART typically space coordinates)</span>
</span><span id="StandardDeviation-498"><a href="#StandardDeviation-498"><span class="linenos">498</span></a>
</span><span id="StandardDeviation-499"><a href="#StandardDeviation-499"><span class="linenos">499</span></a><span class="sd">    Returns</span>
</span><span id="StandardDeviation-500"><a href="#StandardDeviation-500"><span class="linenos">500</span></a><span class="sd">    -------</span>
</span><span id="StandardDeviation-501"><a href="#StandardDeviation-501"><span class="linenos">501</span></a><span class="sd">        Std : float</span>
</span><span id="StandardDeviation-502"><a href="#StandardDeviation-502"><span class="linenos">502</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="StandardDeviation-503"><a href="#StandardDeviation-503"><span class="linenos">503</span></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
</span><span id="StandardDeviation-504"><a href="#StandardDeviation-504"><span class="linenos">504</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">List</span><span class="p">)</span>
</span><span id="StandardDeviation-505"><a href="#StandardDeviation-505"><span class="linenos">505</span></a>    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="StandardDeviation-506"><a href="#StandardDeviation-506"><span class="linenos">506</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="StandardDeviation-507"><a href="#StandardDeviation-507"><span class="linenos">507</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="StandardDeviation-508"><a href="#StandardDeviation-508"><span class="linenos">508</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;StandardDeviation expects a list of floats or numpy-arrays as input, but got something else.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the standard deviation of elements in the supplied list.
If the elements are floats, it's simply the root-mean-square over the numbers.
If the elements are vectors (represented as numpy-arrays), the root-mean-square
of the distance of the points from their mean is calculated.</p>

<h2 id="parameters">Parameters</h2>

<pre><code>List : list of floats or of np.ndarray
    Numbers (in ART, typically delays)
    or 2D or 3D vectors (in ART typically space coordinates)
</code></pre>

<h2 id="returns">Returns</h2>

<pre><code>Std : float
</code></pre>
</div>


                </section>
                <section id="WeightedStandardDeviation">
                            <input id="WeightedStandardDeviation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">WeightedStandardDeviation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">List</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>, </span><span class="param"><span class="n">Weights</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="WeightedStandardDeviation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WeightedStandardDeviation"></a>
            <div class="chroma pdoc-code"><pre><span></span><span id="WeightedStandardDeviation-511"><a href="#WeightedStandardDeviation-511"><span class="linenos">511</span></a><span class="k">def</span> <span class="nf">WeightedStandardDeviation</span><span class="p">(</span><span class="n">List</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">Weights</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="WeightedStandardDeviation-512"><a href="#WeightedStandardDeviation-512"><span class="linenos">512</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="WeightedStandardDeviation-513"><a href="#WeightedStandardDeviation-513"><span class="linenos">513</span></a><span class="sd">    Return the weighted standard deviation of elements in the supplied list.</span>
</span><span id="WeightedStandardDeviation-514"><a href="#WeightedStandardDeviation-514"><span class="linenos">514</span></a><span class="sd">    If the elements are floats, it&#39;s simply the root-mean-square over the weighted numbers.</span>
</span><span id="WeightedStandardDeviation-515"><a href="#WeightedStandardDeviation-515"><span class="linenos">515</span></a><span class="sd">    If the elements are vectors (represented as numpy-arrays), the root-mean-square</span>
</span><span id="WeightedStandardDeviation-516"><a href="#WeightedStandardDeviation-516"><span class="linenos">516</span></a><span class="sd">    of the weighted distances of the points from their mean is calculated.</span>
</span><span id="WeightedStandardDeviation-517"><a href="#WeightedStandardDeviation-517"><span class="linenos">517</span></a>
</span><span id="WeightedStandardDeviation-518"><a href="#WeightedStandardDeviation-518"><span class="linenos">518</span></a><span class="sd">    Parameters</span>
</span><span id="WeightedStandardDeviation-519"><a href="#WeightedStandardDeviation-519"><span class="linenos">519</span></a><span class="sd">    ----------</span>
</span><span id="WeightedStandardDeviation-520"><a href="#WeightedStandardDeviation-520"><span class="linenos">520</span></a><span class="sd">        List : list of floats or of np.ndarray</span>
</span><span id="WeightedStandardDeviation-521"><a href="#WeightedStandardDeviation-521"><span class="linenos">521</span></a><span class="sd">            Numbers (in ART, typically delays)</span>
</span><span id="WeightedStandardDeviation-522"><a href="#WeightedStandardDeviation-522"><span class="linenos">522</span></a><span class="sd">            or 2D or 3D vectors (in ART typically space coordinates)</span>
</span><span id="WeightedStandardDeviation-523"><a href="#WeightedStandardDeviation-523"><span class="linenos">523</span></a>
</span><span id="WeightedStandardDeviation-524"><a href="#WeightedStandardDeviation-524"><span class="linenos">524</span></a><span class="sd">        Weights : list of floats, same length as List</span>
</span><span id="WeightedStandardDeviation-525"><a href="#WeightedStandardDeviation-525"><span class="linenos">525</span></a><span class="sd">            Parameters such as Ray.intensity to be used as weights</span>
</span><span id="WeightedStandardDeviation-526"><a href="#WeightedStandardDeviation-526"><span class="linenos">526</span></a>
</span><span id="WeightedStandardDeviation-527"><a href="#WeightedStandardDeviation-527"><span class="linenos">527</span></a><span class="sd">    Returns</span>
</span><span id="WeightedStandardDeviation-528"><a href="#WeightedStandardDeviation-528"><span class="linenos">528</span></a><span class="sd">    -------</span>
</span><span id="WeightedStandardDeviation-529"><a href="#WeightedStandardDeviation-529"><span class="linenos">529</span></a><span class="sd">        Std : float</span>
</span><span id="WeightedStandardDeviation-530"><a href="#WeightedStandardDeviation-530"><span class="linenos">530</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="WeightedStandardDeviation-531"><a href="#WeightedStandardDeviation-531"><span class="linenos">531</span></a>    <span class="n">average</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">Weights</span><span class="p">,</span> <span class="n">returned</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="WeightedStandardDeviation-532"><a href="#WeightedStandardDeviation-532"><span class="linenos">532</span></a>    <span class="n">variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">((</span><span class="n">List</span> <span class="o">-</span> <span class="n">average</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">Weights</span><span class="p">,</span> <span class="n">returned</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="WeightedStandardDeviation-533"><a href="#WeightedStandardDeviation-533"><span class="linenos">533</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Return the weighted standard deviation of elements in the supplied list.
If the elements are floats, it's simply the root-mean-square over the weighted numbers.
If the elements are vectors (represented as numpy-arrays), the root-mean-square
of the weighted distances of the points from their mean is calculated.</p>

<h2 id="parameters">Parameters</h2>

<pre><code>List : list of floats or of np.ndarray
    Numbers (in ART, typically delays)
    or 2D or 3D vectors (in ART typically space coordinates)

Weights : list of floats, same length as List
    Parameters such as Ray.intensity to be used as weights
</code></pre>

<h2 id="returns">Returns</h2>

<pre><code>Std : float
</code></pre>
</div>


                </section>
                <section id="ReturnNumericalAperture">
                            <input id="ReturnNumericalAperture-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ReturnNumericalAperture</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">RayList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n"><a href="ModuleOpticalRay.html#Ray">ARTcore.ModuleOpticalRay.Ray</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">RefractiveIndex</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="ReturnNumericalAperture-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReturnNumericalAperture"></a>
            <div class="chroma pdoc-code"><pre><span></span><span id="ReturnNumericalAperture-537"><a href="#ReturnNumericalAperture-537"><span class="linenos">537</span></a><span class="k">def</span> <span class="nf">ReturnNumericalAperture</span><span class="p">(</span><span class="n">RayList</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">mray</span><span class="o">.</span><span class="n">Ray</span><span class="p">],</span> <span class="n">RefractiveIndex</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="ReturnNumericalAperture-538"><a href="#ReturnNumericalAperture-538"><span class="linenos">538</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ReturnNumericalAperture-539"><a href="#ReturnNumericalAperture-539"><span class="linenos">539</span></a><span class="sd">    Returns the numerical aperture associated with the supplied ray-bundle &#39;Raylist&#39;.</span>
</span><span id="ReturnNumericalAperture-540"><a href="#ReturnNumericalAperture-540"><span class="linenos">540</span></a><span class="sd">    This is $n\sin\theta$, where $\theta$ is the maximum angle between any of the rays and the central ray,</span>
</span><span id="ReturnNumericalAperture-541"><a href="#ReturnNumericalAperture-541"><span class="linenos">541</span></a><span class="sd">    and $n$ is the refractive index of the propagation medium.</span>
</span><span id="ReturnNumericalAperture-542"><a href="#ReturnNumericalAperture-542"><span class="linenos">542</span></a>
</span><span id="ReturnNumericalAperture-543"><a href="#ReturnNumericalAperture-543"><span class="linenos">543</span></a><span class="sd">    Parameters</span>
</span><span id="ReturnNumericalAperture-544"><a href="#ReturnNumericalAperture-544"><span class="linenos">544</span></a><span class="sd">    ----------</span>
</span><span id="ReturnNumericalAperture-545"><a href="#ReturnNumericalAperture-545"><span class="linenos">545</span></a><span class="sd">        RayList : list of Ray-object</span>
</span><span id="ReturnNumericalAperture-546"><a href="#ReturnNumericalAperture-546"><span class="linenos">546</span></a><span class="sd">            The ray-bundle of which to determine the NA.</span>
</span><span id="ReturnNumericalAperture-547"><a href="#ReturnNumericalAperture-547"><span class="linenos">547</span></a>
</span><span id="ReturnNumericalAperture-548"><a href="#ReturnNumericalAperture-548"><span class="linenos">548</span></a><span class="sd">        RefractiveIndex : float, optional</span>
</span><span id="ReturnNumericalAperture-549"><a href="#ReturnNumericalAperture-549"><span class="linenos">549</span></a><span class="sd">            Refractive index of the propagation medium, defaults to =1.</span>
</span><span id="ReturnNumericalAperture-550"><a href="#ReturnNumericalAperture-550"><span class="linenos">550</span></a>
</span><span id="ReturnNumericalAperture-551"><a href="#ReturnNumericalAperture-551"><span class="linenos">551</span></a><span class="sd">    Returns</span>
</span><span id="ReturnNumericalAperture-552"><a href="#ReturnNumericalAperture-552"><span class="linenos">552</span></a><span class="sd">    -------</span>
</span><span id="ReturnNumericalAperture-553"><a href="#ReturnNumericalAperture-553"><span class="linenos">553</span></a><span class="sd">        NA : float</span>
</span><span id="ReturnNumericalAperture-554"><a href="#ReturnNumericalAperture-554"><span class="linenos">554</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ReturnNumericalAperture-555"><a href="#ReturnNumericalAperture-555"><span class="linenos">555</span></a>    <span class="n">CentralRay</span> <span class="o">=</span> <span class="n">FindCentralRay</span><span class="p">(</span><span class="n">RayList</span><span class="p">)</span>
</span><span id="ReturnNumericalAperture-556"><a href="#ReturnNumericalAperture-556"><span class="linenos">556</span></a>    <span class="k">if</span> <span class="n">CentralRay</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReturnNumericalAperture-557"><a href="#ReturnNumericalAperture-557"><span class="linenos">557</span></a>        <span class="n">CentralVector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="ReturnNumericalAperture-558"><a href="#ReturnNumericalAperture-558"><span class="linenos">558</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">RayList</span><span class="p">:</span>
</span><span id="ReturnNumericalAperture-559"><a href="#ReturnNumericalAperture-559"><span class="linenos">559</span></a>            <span class="n">CentralVector</span> <span class="o">=</span> <span class="n">CentralVector</span> <span class="o">+</span> <span class="n">k</span><span class="o">.</span><span class="n">vector</span>
</span><span id="ReturnNumericalAperture-560"><a href="#ReturnNumericalAperture-560"><span class="linenos">560</span></a>        <span class="n">CentralVector</span> <span class="o">=</span> <span class="n">CentralVector</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">RayList</span><span class="p">)</span>
</span><span id="ReturnNumericalAperture-561"><a href="#ReturnNumericalAperture-561"><span class="linenos">561</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="ReturnNumericalAperture-562"><a href="#ReturnNumericalAperture-562"><span class="linenos">562</span></a>        <span class="n">CentralVector</span> <span class="o">=</span> <span class="n">CentralRay</span><span class="o">.</span><span class="n">vector</span>
</span><span id="ReturnNumericalAperture-563"><a href="#ReturnNumericalAperture-563"><span class="linenos">563</span></a>    <span class="n">ListAngleAperture</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ReturnNumericalAperture-564"><a href="#ReturnNumericalAperture-564"><span class="linenos">564</span></a>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">RayList</span><span class="p">:</span>
</span><span id="ReturnNumericalAperture-565"><a href="#ReturnNumericalAperture-565"><span class="linenos">565</span></a>        <span class="n">ListAngleAperture</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mgeo</span><span class="o">.</span><span class="n">AngleBetweenTwoVectors</span><span class="p">(</span><span class="n">CentralVector</span><span class="p">,</span> <span class="n">k</span><span class="o">.</span><span class="n">vector</span><span class="p">))</span>
</span><span id="ReturnNumericalAperture-566"><a href="#ReturnNumericalAperture-566"><span class="linenos">566</span></a>
</span><span id="ReturnNumericalAperture-567"><a href="#ReturnNumericalAperture-567"><span class="linenos">567</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">ListAngleAperture</span><span class="p">))</span> <span class="o">*</span> <span class="n">RefractiveIndex</span>
</span></pre></div>


            <div class="docstring"><p>Returns the numerical aperture associated with the supplied ray-bundle 'Raylist'.
This is $n\sin\theta$, where $\theta$ is the maximum angle between any of the rays and the central ray,
and $n$ is the refractive index of the propagation medium.</p>

<h2 id="parameters">Parameters</h2>

<pre><code>RayList : list of Ray-object
    The ray-bundle of which to determine the NA.

RefractiveIndex : float, optional
    Refractive index of the propagation medium, defaults to =1.
</code></pre>

<h2 id="returns">Returns</h2>

<pre><code>NA : float
</code></pre>
</div>


                </section>
                <section id="ReturnAiryRadius">
                            <input id="ReturnAiryRadius-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ReturnAiryRadius</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">Wavelength</span><span class="p">:</span> <span class="nb">float</span>, </span><span class="param"><span class="n">NumericalAperture</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="ReturnAiryRadius-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReturnAiryRadius"></a>
            <div class="chroma pdoc-code"><pre><span></span><span id="ReturnAiryRadius-571"><a href="#ReturnAiryRadius-571"><span class="linenos">571</span></a><span class="k">def</span> <span class="nf">ReturnAiryRadius</span><span class="p">(</span><span class="n">Wavelength</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">NumericalAperture</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="ReturnAiryRadius-572"><a href="#ReturnAiryRadius-572"><span class="linenos">572</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ReturnAiryRadius-573"><a href="#ReturnAiryRadius-573"><span class="linenos">573</span></a><span class="sd">    Returns the radius of the Airy disk: $r = 1.22 \frac\{\lambda\}\{NA\}$,</span>
</span><span id="ReturnAiryRadius-574"><a href="#ReturnAiryRadius-574"><span class="linenos">574</span></a><span class="sd">    i.e. the diffraction-limited radius of the focal spot corresponding to a given</span>
</span><span id="ReturnAiryRadius-575"><a href="#ReturnAiryRadius-575"><span class="linenos">575</span></a><span class="sd">    numerical aperture $NA$ and a light wavelength $\lambda$.</span>
</span><span id="ReturnAiryRadius-576"><a href="#ReturnAiryRadius-576"><span class="linenos">576</span></a>
</span><span id="ReturnAiryRadius-577"><a href="#ReturnAiryRadius-577"><span class="linenos">577</span></a><span class="sd">    For very small $NA&lt;10^\{-3\}$, diffraction effects becomes negligible and the Airy Radius becomes meaningless,</span>
</span><span id="ReturnAiryRadius-578"><a href="#ReturnAiryRadius-578"><span class="linenos">578</span></a><span class="sd">    so in that case, a radius of 0 is returned.</span>
</span><span id="ReturnAiryRadius-579"><a href="#ReturnAiryRadius-579"><span class="linenos">579</span></a>
</span><span id="ReturnAiryRadius-580"><a href="#ReturnAiryRadius-580"><span class="linenos">580</span></a><span class="sd">    Parameters</span>
</span><span id="ReturnAiryRadius-581"><a href="#ReturnAiryRadius-581"><span class="linenos">581</span></a><span class="sd">    ----------</span>
</span><span id="ReturnAiryRadius-582"><a href="#ReturnAiryRadius-582"><span class="linenos">582</span></a><span class="sd">        Wavelength : float</span>
</span><span id="ReturnAiryRadius-583"><a href="#ReturnAiryRadius-583"><span class="linenos">583</span></a><span class="sd">            Light wavelength in mm.</span>
</span><span id="ReturnAiryRadius-584"><a href="#ReturnAiryRadius-584"><span class="linenos">584</span></a>
</span><span id="ReturnAiryRadius-585"><a href="#ReturnAiryRadius-585"><span class="linenos">585</span></a><span class="sd">        NumericalAperture : float</span>
</span><span id="ReturnAiryRadius-586"><a href="#ReturnAiryRadius-586"><span class="linenos">586</span></a>
</span><span id="ReturnAiryRadius-587"><a href="#ReturnAiryRadius-587"><span class="linenos">587</span></a><span class="sd">    Returns</span>
</span><span id="ReturnAiryRadius-588"><a href="#ReturnAiryRadius-588"><span class="linenos">588</span></a><span class="sd">    -------</span>
</span><span id="ReturnAiryRadius-589"><a href="#ReturnAiryRadius-589"><span class="linenos">589</span></a><span class="sd">        AiryRadius : float</span>
</span><span id="ReturnAiryRadius-590"><a href="#ReturnAiryRadius-590"><span class="linenos">590</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ReturnAiryRadius-591"><a href="#ReturnAiryRadius-591"><span class="linenos">591</span></a>    <span class="k">if</span> <span class="n">NumericalAperture</span> <span class="o">&gt;</span> <span class="mf">1e-3</span> <span class="ow">and</span> <span class="n">Wavelength</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReturnAiryRadius-592"><a href="#ReturnAiryRadius-592"><span class="linenos">592</span></a>        <span class="k">return</span> <span class="mf">1.22</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">Wavelength</span> <span class="o">/</span> <span class="n">NumericalAperture</span>
</span><span id="ReturnAiryRadius-593"><a href="#ReturnAiryRadius-593"><span class="linenos">593</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="ReturnAiryRadius-594"><a href="#ReturnAiryRadius-594"><span class="linenos">594</span></a>        <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># for very small numerical apertures, diffraction effects becomes negligible and the Airy Radius becomes meaningless</span>
</span></pre></div>


            <div class="docstring"><p>Returns the radius of the Airy disk: $r = 1.22 \frac{\lambda}{NA}$,
i.e. the diffraction-limited radius of the focal spot corresponding to a given
numerical aperture $NA$ and a light wavelength $\lambda$.</p>

<p>For very small $NA&lt;10^{-3}$, diffraction effects becomes negligible and the Airy Radius becomes meaningless,
so in that case, a radius of 0 is returned.</p>

<h2 id="parameters">Parameters</h2>

<pre><code>Wavelength : float
    Light wavelength in mm.

NumericalAperture : float
</code></pre>

<h2 id="returns">Returns</h2>

<pre><code>AiryRadius : float
</code></pre>
</div>


                </section>
                <section id="save_compressed">
                            <input id="save_compressed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_compressed</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">obj</span>, </span><span class="param"><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="save_compressed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#save_compressed"></a>
            <div class="chroma pdoc-code"><pre><span></span><span id="save_compressed-613"><a href="#save_compressed-613"><span class="linenos">613</span></a><span class="k">def</span> <span class="nf">save_compressed</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="save_compressed-614"><a href="#save_compressed-614"><span class="linenos">614</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Save (=pickle) an object &#39;obj&#39; to a compressed file with name &#39;filename&#39;.&quot;&quot;&quot;</span>
</span><span id="save_compressed-615"><a href="#save_compressed-615"><span class="linenos">615</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="save_compressed-616"><a href="#save_compressed-616"><span class="linenos">616</span></a>        <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;kept_data_&quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">-%Hh%M&quot;</span><span class="p">)</span>
</span><span id="save_compressed-617"><a href="#save_compressed-617"><span class="linenos">617</span></a>
</span><span id="save_compressed-618"><a href="#save_compressed-618"><span class="linenos">618</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="save_compressed-619"><a href="#save_compressed-619"><span class="linenos">619</span></a>    <span class="k">while</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.xz&quot;</span><span class="p">):</span>
</span><span id="save_compressed-620"><a href="#save_compressed-620"><span class="linenos">620</span></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="save_compressed-621"><a href="#save_compressed-621"><span class="linenos">621</span></a>    <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="save_compressed-622"><a href="#save_compressed-622"><span class="linenos">622</span></a>    <span class="c1"># with gzip.open(filename + &#39;.gz&#39;, &#39;wb&#39;) as f:</span>
</span><span id="save_compressed-623"><a href="#save_compressed-623"><span class="linenos">623</span></a>    <span class="k">with</span> <span class="n">lzma</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.xz&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="save_compressed-624"><a href="#save_compressed-624"><span class="linenos">624</span></a>        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</span><span id="save_compressed-625"><a href="#save_compressed-625"><span class="linenos">625</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved results to &quot;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.xz.&quot;</span><span class="p">)</span>
</span><span id="save_compressed-626"><a href="#save_compressed-626"><span class="linenos">626</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&gt;To reload from disk do: kept_data = mp.load_compressed(&#39;&quot;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;&#39;)&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save (=pickle) an object 'obj' to a compressed file with name 'filename'.</p>
</div>


                </section>
                <section id="load_compressed">
                            <input id="load_compressed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_compressed</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="load_compressed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#load_compressed"></a>
            <div class="chroma pdoc-code"><pre><span></span><span id="load_compressed-629"><a href="#load_compressed-629"><span class="linenos">629</span></a><span class="k">def</span> <span class="nf">load_compressed</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="load_compressed-630"><a href="#load_compressed-630"><span class="linenos">630</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Load (=unpickle) an object &#39;obj&#39; from a compressed file with name &#39;filename&#39;.&quot;&quot;&quot;</span>
</span><span id="load_compressed-631"><a href="#load_compressed-631"><span class="linenos">631</span></a>    <span class="c1"># with gzip.open(filename + &#39;.gz&#39;, &#39;rb&#39;) as f:</span>
</span><span id="load_compressed-632"><a href="#load_compressed-632"><span class="linenos">632</span></a>    <span class="k">with</span> <span class="n">lzma</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.xz&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="load_compressed-633"><a href="#load_compressed-633"><span class="linenos">633</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="load_compressed-634"><a href="#load_compressed-634"><span class="linenos">634</span></a>    <span class="k">return</span> <span class="n">obj</span>
</span></pre></div>


            <div class="docstring"><p>Load (=unpickle) an object 'obj' from a compressed file with name 'filename'.</p>
</div>


                </section>
</div>


<style>pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
<style>:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
<style>.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>